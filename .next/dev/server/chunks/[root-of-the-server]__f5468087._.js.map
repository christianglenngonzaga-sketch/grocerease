{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Terryl%20Jean/Downloads/grocer-ease-sql-schema/lib/db.ts"],"sourcesContent":["import mysql from \"mysql2/promise\";\r\n\r\nconst pool = mysql.createPool({\r\n  host: process.env.DB_HOST ?? \"127.0.0.1\",\r\n  user: process.env.DB_USER ?? \"root\",\r\n  password: process.env.DB_PASSWORD ?? \"\",\r\n  database: process.env.DB_NAME ?? \"grocerease\",\r\n  waitForConnections: true,\r\n  connectionLimit: 10,\r\n  queueLimit: 0,\r\n});\r\n\r\nexport default pool;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,OAAO,iLAAK,CAAC,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;AACd;uCAEe"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Terryl%20Jean/Downloads/grocer-ease-sql-schema/lib/auth.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\"\r\n\r\nconst SECRET = process.env.JWT_SECRET ?? \"change-this-secret\"\r\n\r\nexport function signToken(payload: object): string {\r\n  return jwt.sign(payload, SECRET, { expiresIn: \"7d\" })\r\n}\r\n\r\nexport function verifyToken(token?: string): any | null {\r\n  if (!token) return null\r\n  try {\r\n    const t = token.replace(/^Bearer\\s+/i, \"\")\r\n    return jwt.verify(t, SECRET) as any\r\n  } catch {\r\n    return null\r\n  }\r\n}"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI;AAElC,SAAS,UAAU,OAAe;IACvC,OAAO,qLAAG,CAAC,IAAI,CAAC,SAAS,QAAQ;QAAE,WAAW;IAAK;AACrD;AAEO,SAAS,YAAY,KAAc;IACxC,IAAI,CAAC,OAAO,OAAO;IACnB,IAAI;QACF,MAAM,IAAI,MAAM,OAAO,CAAC,eAAe;QACvC,OAAO,qLAAG,CAAC,MAAM,CAAC,GAAG;IACvB,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Terryl%20Jean/Downloads/grocer-ease-sql-schema/app/api/items/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport pool from \"@/lib/db\"\nimport { verifyToken } from \"@/lib/auth\"\n\nexport async function PATCH(req: Request, { params }: { params: { id: string } }) {\n  try {\n    const auth = req.headers.get(\"authorization\") ?? \"\"\n    const payload = verifyToken(auth)\n    if (!payload?.userId) return NextResponse.json({ error: \"unauthorized\" }, { status: 401 })\n\n    const id = Number(params.id)\n    const body = await req.json()\n\n    const fields: string[] = []\n    const values: any[] = []\n\n    for (const key of [\n      \"name\",\n      \"quantity\",\n      \"quantity_unit\",\n      \"notes\",\n      \"category_id\",\n      \"purchased\",\n      \"priority\",\n      \"estimated_price\",\n    ]) {\n      if (key in body) {\n        if (key === \"purchased\") {\n          const v = !!(body as any)[key]\n          // set purchased and set/clear purchased_at atomically\n          if (v) {\n            fields.push(`purchased = ? , purchased_at = CURRENT_TIMESTAMP`)\n            values.push(1)\n          } else {\n            fields.push(`purchased = ? , purchased_at = NULL`)\n            values.push(0)\n          }\n        } else {\n          fields.push(`${key} = ?`)\n          values.push((body as any)[key])\n        }\n      }\n    }\n\n    if (fields.length === 0) return NextResponse.json({ error: \"no fields to update\" }, { status: 400 })\n\n    values.push(payload.userId, id)\n    const sql = `UPDATE items SET ${fields.join(\", \")} WHERE user_id = ? AND id = ?`\n    await pool.execute(sql, values)\n\n    // return updated item\n    const [rows] = await pool.execute(\"SELECT * FROM items WHERE user_id = ? AND id = ?\", [payload.userId, id])\n    const updated = (rows as any[])[0] ?? null\n\n    return NextResponse.json({ item: updated })\n  } catch (err) {\n    console.error(err)\n    return NextResponse.json({ error: \"server error\" }, { status: 500 })\n  }\n}\n\nexport async function PUT(req: Request, { params }: { params: { id: string } }) {\n  try {\n    const auth = req.headers.get(\"authorization\") ?? \"\"\n    const payload = verifyToken(auth)\n    if (!payload?.userId) return NextResponse.json({ error: \"unauthorized\" }, { status: 401 })\n\n    const id = Number(params.id)\n    const body = await req.json()\n\n    const fields: string[] = []\n    const values: any[] = []\n\n    for (const key of [\n      \"name\",\n      \"quantity\",\n      \"quantity_unit\",\n      \"notes\",\n      \"category_id\",\n      \"purchased\",\n      \"priority\",\n      \"estimated_price\",\n    ]) {\n      if (key in body) {\n        fields.push(`${key} = ?`)\n        let v = (body as any)[key]\n        if (key === \"purchased\") v = v ? 1 : 0\n        values.push(v)\n      }\n    }\n\n    if (fields.length === 0) return NextResponse.json({ error: \"no fields to update\" }, { status: 400 })\n\n    values.push(payload.userId, id)\n    const sql = `UPDATE items SET ${fields.join(\", \")} WHERE user_id = ? AND id = ?`\n    await pool.execute(sql, values)\n\n    return NextResponse.json({ success: true })\n  } catch (err) {\n    console.error(err)\n    return NextResponse.json({ error: \"server error\" }, { status: 500 })\n  }\n}\n\nexport async function DELETE(req: Request, { params }: { params: { id: string } }) {\n  try {\n    const auth = req.headers.get(\"authorization\") ?? \"\"\n    const payload = verifyToken(auth)\n    if (!payload?.userId) return NextResponse.json({ error: \"unauthorized\" }, { status: 401 })\n\n    const id = Number(params.id)\n    await pool.execute(\"DELETE FROM items WHERE user_id = ? AND id = ?\", [payload.userId, id])\n\n    return NextResponse.json({ success: true })\n  } catch (err) {\n    console.error(err)\n    return NextResponse.json({ error: \"server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}