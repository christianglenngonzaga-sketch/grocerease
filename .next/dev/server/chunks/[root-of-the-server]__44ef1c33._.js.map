{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Terryl%20Jean/Downloads/grocer-ease-sql-schema/lib/db.ts"],"sourcesContent":["import mysql from \"mysql2/promise\";\r\n\r\nconst pool = mysql.createPool({\r\n  host: process.env.DB_HOST ?? \"127.0.0.1\",\r\n  user: process.env.DB_USER ?? \"root\",\r\n  password: process.env.DB_PASSWORD ?? \"\",\r\n  database: process.env.DB_NAME ?? \"grocerease\",\r\n  waitForConnections: true,\r\n  connectionLimit: 10,\r\n  queueLimit: 0,\r\n});\r\n\r\nexport default pool;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,OAAO,iLAAK,CAAC,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;AACd;uCAEe"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Terryl%20Jean/Downloads/grocer-ease-sql-schema/lib/auth.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\"\r\n\r\nconst SECRET = process.env.JWT_SECRET ?? \"change-this-secret\"\r\n\r\nexport function signToken(payload: object): string {\r\n  return jwt.sign(payload, SECRET, { expiresIn: \"7d\" })\r\n}\r\n\r\nexport function verifyToken(token?: string): any | null {\r\n  if (!token) return null\r\n  try {\r\n    const t = token.replace(/^Bearer\\s+/i, \"\")\r\n    return jwt.verify(t, SECRET) as any\r\n  } catch {\r\n    return null\r\n  }\r\n}"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI;AAElC,SAAS,UAAU,OAAe;IACvC,OAAO,qLAAG,CAAC,IAAI,CAAC,SAAS,QAAQ;QAAE,WAAW;IAAK;AACrD;AAEO,SAAS,YAAY,KAAc;IACxC,IAAI,CAAC,OAAO,OAAO;IACnB,IAAI;QACF,MAAM,IAAI,MAAM,OAAO,CAAC,eAAe;QACvC,OAAO,qLAAG,CAAC,MAAM,CAAC,GAAG;IACvB,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Terryl%20Jean/Downloads/grocer-ease-sql-schema/app/api/items/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport pool from \"@/lib/db\"\nimport { verifyToken } from \"@/lib/auth\"\n\nexport async function GET(req: Request) {\n  try {\n    const auth = req.headers.get(\"authorization\") ?? \"\"\n    const payload = verifyToken(auth)\n    if (!payload?.userId)\n      return NextResponse.json({ error: \"unauthorized\" }, { status: 401 })\n\n    const url = new URL(req.url)\n    const filter = url.searchParams.get(\"filter\") // all|purchased|pending\n    let sql = \"SELECT * FROM items WHERE user_id = ?\"\n    const params: any[] = [payload.userId]\n    if (filter === \"purchased\") {\n      sql += \" AND purchased = 1\"\n    } else if (filter === \"pending\") {\n      sql += \" AND (purchased = 0 OR purchased IS NULL)\"\n    }\n    sql += \" ORDER BY created_at DESC\"\n    const [rows] = await pool.execute(sql, params)\n    return NextResponse.json({ items: rows })\n  } catch (err) {\n    console.error(err)\n    return NextResponse.json({ error: \"server error\" }, { status: 500 })\n  }\n}\n\nexport async function POST(req: Request) {\n  try {\n    const auth = req.headers.get(\"authorization\") ?? \"\"\n    const payload = verifyToken(auth)\n    if (!payload?.userId)\n      return NextResponse.json({ error: \"unauthorized\" }, { status: 401 })\n\n    const body = await req.json()\n    const {\n      name,\n      quantity = 1,\n      quantity_unit = \"pcs\",\n      notes = null,\n      category_id = null,\n      purchased = false,\n      priority = \"medium\",\n      estimated_price = null,\n    } = body\n\n    if (!name)\n      return NextResponse.json({ error: \"name required\" }, { status: 400 })\n\n    const [res] = await pool.execute(\n      `INSERT INTO items\n      (user_id, category_id, name, quantity, quantity_unit, notes, purchased, priority, estimated_price)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)`,\n      [\n        payload.userId,\n        category_id,\n        name,\n        quantity,\n        quantity_unit,\n        notes,\n        purchased ? 1 : 0,\n        priority,\n        estimated_price,\n      ]\n    )\n\n    const id = (res as any).insertId\n    return NextResponse.json(\n      {\n        item: {\n          id,\n          user_id: payload.userId,\n          name,\n          quantity,\n          quantity_unit,\n          category_id,\n          notes,\n          purchased,\n          priority,\n          estimated_price,\n        },\n      },\n      { status: 201 }\n    )\n  } catch (err) {\n    console.error(err)\n    return NextResponse.json({ error: \"server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,GAAY;IACpC,IAAI;QACF,MAAM,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,oBAAoB;QACjD,MAAM,UAAU,IAAA,+JAAW,EAAC;QAC5B,IAAI,CAAC,SAAS,QACZ,OAAO,mLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAEpE,MAAM,MAAM,IAAI,IAAI,IAAI,GAAG;QAC3B,MAAM,SAAS,IAAI,YAAY,CAAC,GAAG,CAAC,UAAU,wBAAwB;;QACtE,IAAI,MAAM;QACV,MAAM,SAAgB;YAAC,QAAQ,MAAM;SAAC;QACtC,IAAI,WAAW,aAAa;YAC1B,OAAO;QACT,OAAO,IAAI,WAAW,WAAW;YAC/B,OAAO;QACT;QACA,OAAO;QACP,MAAM,CAAC,KAAK,GAAG,MAAM,yJAAI,CAAC,OAAO,CAAC,KAAK;QACvC,OAAO,mLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAK;IACzC,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,mLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,oBAAoB;QACjD,MAAM,UAAU,IAAA,+JAAW,EAAC;QAC5B,IAAI,CAAC,SAAS,QACZ,OAAO,mLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAEpE,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EACJ,IAAI,EACJ,WAAW,CAAC,EACZ,gBAAgB,KAAK,EACrB,QAAQ,IAAI,EACZ,cAAc,IAAI,EAClB,YAAY,KAAK,EACjB,WAAW,QAAQ,EACnB,kBAAkB,IAAI,EACvB,GAAG;QAEJ,IAAI,CAAC,MACH,OAAO,mLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;QAErE,MAAM,CAAC,IAAI,GAAG,MAAM,yJAAI,CAAC,OAAO,CAC9B,CAAC;;wCAEiC,CAAC,EACnC;YACE,QAAQ,MAAM;YACd;YACA;YACA;YACA;YACA;YACA,YAAY,IAAI;YAChB;YACA;SACD;QAGH,MAAM,KAAK,AAAC,IAAY,QAAQ;QAChC,OAAO,mLAAY,CAAC,IAAI,CACtB;YACE,MAAM;gBACJ;gBACA,SAAS,QAAQ,MAAM;gBACvB;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;YACF;QACF,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,mLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}